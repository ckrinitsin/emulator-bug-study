Code Flushing: Improve tracking data structures
Follow up from #705 

Having page lists in a map might be a good solution, but we probably need to look into some better data structures.