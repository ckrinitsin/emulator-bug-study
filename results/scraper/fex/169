ELF Handling code relies on section headers
Nearly all of the elf processing uses section headers,  which are very convenient to work with as there is much more information and split better.

The problem is section headers can be stripped off,  while it's rare it's perfectly valid and only program headers are needed to build the process image.

