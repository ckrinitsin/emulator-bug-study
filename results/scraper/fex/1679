Fully validate / handle highly contested multithreaded invalidations
Split off from #1671, which tries to be multi threading safe, but hasn't been fully vetted or verified that it always behaves correctly.

This was out of scope for the initial SMC PR, and even though it has worked in my tests, it should be revisited.