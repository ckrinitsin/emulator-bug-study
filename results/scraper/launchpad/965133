Sparc64 crash on start

qemu version 1.0.1 compiled on a Ubuntu live on a HP laptop win a x64 architecture.

With more than 4G of memory sparc64 machine crash on start.

command line: qemu-system-sparc64 -m 4G

output:
VNC server running on `127.0.0.1:5900'
qemu: fatal: Trap 0x0064 while trap level (5) >= MAXTL (5), Error state
pc: 00000000ffd04c80  npc: 00000000ffd04c84
General Registers:
%g0-3: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
%g4-7: 0000000000000000 0000000000000000 0000000000000000 0000000000000000

Current Register Window:
%o0-3: 00000000ffd00000 0000000000080000 0000000000080000 0000000000000000 
%o4-7: 0000000000000000 0000000000000000 00000000fff754e1 00000000ffd144d4 
%l0-3: 0000000100000000 00000000fff75c4d 0000000000000000 0000000000000000 
%l4-7: 0000000000000000 0000000000000000 0000000000000000 0000000000000000 
%i0-3: 0000000000000000 0000000000000000 0000000100000000 0000000000000036 
%i4-7: 00000000ffe87418 00000000ffe87648 00000000fff75591 00000000ffd0bf54 

Floating Point Registers:
%f00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
%f08: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
%f16: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
%f24: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
%f32: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
%f40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
%f48: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
%f56: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
pstate: 00000414 ccr: 99 (icc: N--C xcc: N--C) asi: 00 tl: 5 pil: 0
cansave: 5 canrestore: 1 otherwin: 0 wstate: 0 cleanwin: 6 cwp: 3
fsr: 0000000000000000 y: 0000000000000000 fprs: 0000000000000000
Aborted (core dumped)

On Mon, Mar 26, 2012 at 10:27, Tiziano Vecchi <email address hidden> wrote:
> Public bug reported:
>
> qemu version 1.0.1 compiled on a Ubuntu live on a HP laptop win a x64
> architecture.
>
> With more than 4G of memory sparc64 machine crash on start.
>
> command line: qemu-system-sparc64 -m 4G
>
> output:
> VNC server running on `127.0.0.1:5900'
> qemu: fatal: Trap 0x0064 while trap level (5) >= MAXTL (5), Error state
> pc: 00000000ffd04c80  npc: 00000000ffd04c84
> General Registers:
> %g0-3: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
> %g4-7: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>
> Current Register Window:
> %o0-3: 00000000ffd00000 0000000000080000 0000000000080000 0000000000000000
> %o4-7: 0000000000000000 0000000000000000 00000000fff754e1 00000000ffd144d4
> %l0-3: 0000000100000000 00000000fff75c4d 0000000000000000 0000000000000000
> %l4-7: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
> %i0-3: 0000000000000000 0000000000000000 0000000100000000 0000000000000036
> %i4-7: 00000000ffe87418 00000000ffe87648 00000000fff75591 00000000ffd0bf54
>
> Floating Point Registers:
> %f00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
> %f08: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
> %f16: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
> %f24: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
> %f32: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
> %f40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
> %f48: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
> %f56: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
> pstate: 00000414 ccr: 99 (icc: N--C xcc: N--C) asi: 00 tl: 5 pil: 0
> cansave: 5 canrestore: 1 otherwin: 0 wstate: 0 cleanwin: 6 cwp: 3
> fsr: 0000000000000000 y: 0000000000000000 fprs: 0000000000000000
> Aborted (core dumped)

This is actually a bug in OpenBIOS. It is mapped at 0xffd00000 (below
4G) for compatibility with 32 bit code, but the code does not handle
this case where top of RAM overlaps OpenBIOS.

>
> ** Affects: qemu
>     Importance: Undecided
>         Status: New
>
> --
> You received this bug notification because you are a member of qemu-
> devel-ml, which is subscribed to QEMU.
> https://bugs.launchpad.net/bugs/965133
>
> Title:
>  Sparc64 crash on start
>
> Status in QEMU:
>  New
>
> Bug description:
>  qemu version 1.0.1 compiled on a Ubuntu live on a HP laptop win a x64
>  architecture.
>
>  With more than 4G of memory sparc64 machine crash on start.
>
>  command line: qemu-system-sparc64 -m 4G
>
>  output:
>  VNC server running on `127.0.0.1:5900'
>  qemu: fatal: Trap 0x0064 while trap level (5) >= MAXTL (5), Error state
>  pc: 00000000ffd04c80  npc: 00000000ffd04c84
>  General Registers:
>  %g0-3: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>  %g4-7: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>
>  Current Register Window:
>  %o0-3: 00000000ffd00000 0000000000080000 0000000000080000 0000000000000000
>  %o4-7: 0000000000000000 0000000000000000 00000000fff754e1 00000000ffd144d4
>  %l0-3: 0000000100000000 00000000fff75c4d 0000000000000000 0000000000000000
>  %l4-7: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>  %i0-3: 0000000000000000 0000000000000000 0000000100000000 0000000000000036
>  %i4-7: 00000000ffe87418 00000000ffe87648 00000000fff75591 00000000ffd0bf54
>
>  Floating Point Registers:
>  %f00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>  %f08: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>  %f16: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>  %f24: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>  %f32: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>  %f40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>  %f48: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>  %f56: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
>  pstate: 00000414 ccr: 99 (icc: N--C xcc: N--C) asi: 00 tl: 5 pil: 0
>  cansave: 5 canrestore: 1 otherwin: 0 wstate: 0 cleanwin: 6 cwp: 3
>  fsr: 0000000000000000 y: 0000000000000000 fprs: 0000000000000000
>  Aborted (core dumped)
>
> To manage notifications about this bug go to:
> https://bugs.launchpad.net/qemu/+bug/965133/+subscriptions
>


Can you still reproduce this problem with the latest version of QEMU / OpenBIOS?

[Expired for QEMU because there has been no activity for 60 days.]

