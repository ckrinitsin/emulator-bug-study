id = 1585
title = "Incorrect VGA text mode rendering"
state = "opened"
created_at = "2023-04-08T02:58:20.009Z"
closed_at = "n/a"
labels = []
url = "https://gitlab.com/qemu-project/qemu/-/issues/1585"
host-os = "Ubuntu in WSL2 with X-Forwarding"
host-arch = "x86_64"
qemu-version = "6.2.0"
guest-os = "[TheDevMinerTV/os](https://github.com/TheDevMinerTV/os)"
guest-arch = "i386"
description = """All of my physical machines use black as `DarkGray` and have the text starting from `White+DarkGray` blink (watch the video below). The ISO I'm using is a minimal kernel I've written to check VGA text mode (provided by the BIOS at `0xb8000` with a 80x25 resolution) handling on multiple emulators and machines.
Changing the emulated CPU and display driver doesn't change this behaviour.

Hyper-V: color test shows correct colors, all text starting from `White+DarkGray` is blinking

![Hyper-V](/uploads/0d6e9a2398d0f5aeca94e6fbbc31e055/image.png)

AMD Athlon 64 X2 6000+ + NVIDIA Quadro 400 on actual hardware: same as Hyper-V
I've tested this with multiple physical GPUs and they all have the same behaviour and color palette.

![AMD Athlon 64 X2 6000+ + NVIDIA Quadro 400](/uploads/883484cea78f8d598634ebab3645341c/image.png)

QEMU: dark gray is the wrong color and the text doesn't blink
Changing the emulated device doesn't change this behaviour.

![QEMU](/uploads/cf1e6a1e7e8bcfc48b60bd92d9024de5/image.png)

I think QEMU should emulate the hardware as close as possible and therefore atleast have the blinking text.
Consider this a low priority issue."""
reproduce = """1. Download ISO from the link above
2. Run the QEMU command above
3. See the text not blink"""
additional = """![Demo of various machines](/uploads/9de70ecd2185bdb57b3ee324fe18dcd9/2023-04-08_04-56-05.mp4)"""
