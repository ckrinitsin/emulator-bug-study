other: 0.362
socket: 0.326
device: 0.312
boot: 0.258
graphic: 0.221
semantic: 0.215
vnc: 0.185
PID: 0.176
network: 0.146
performance: 0.104
permissions: 0.096
debug: 0.083
files: 0.068
KVM: 0.031

Compilation fails with "ld: Error: unable to disambiguate: -no-pie (did you mean --no-pie ?)"

It compiles until the end and then just:
[6102/6103] Linking target qemu-system-alpha
[6103/6103] Linking target qemu-system-aarch64
make[1]: Leaving directory '/home/t/.cache/kiss/proc/32129/build/qemu/build'
make: *** [GNUmakefile:11: all] Error 2

Attached is the complete log including configure. I can't find why this is happening maybe I have a wrong version of a required library?

Any ideas?



This isn't silent: the log says:

  BUILD   multiboot.img
ld: Error: unable to disambiguate: -no-pie (did you mean --no-pie ?)

Which version of QEMU are you trying to build? Does this happen with head-of-git ?


I could not find 
This is how it is configured:
./configure \
    --prefix=/usr \
    --localstatedir=/var \
    --sysconfdir=/etc \
    --enable-debug-info \
    --disable-gtk \
    --disable-docs \
    --enable-sdl \
    --enable-kvm \
    --enable-pie \
    --enable-curses \
    --disable-user \
    --disable-linux-user \
    --enable-system

Version: 5.2.0

Also this:
$ grep "\-no\-pie" configure
# Check we support --no-pie first; we will need this for building ROMs.
if compile_prog "-Werror -fno-pie" "-no-pie"; then
  LDFLAGS_NOPIE="-no-pie"

Adding another hyphen is not helping either.

I tried to comment out the whole block:
#if compile_prog "-Werror -fno-pie" "-no-pie"; then
  # CFLAGS_NOPIE="-fno-pie"
  # LDFLAGS_NOPIE="-no-pie"
#fi

And it compiled and linked without any problem. 




This is already fixed in upstream QEMU in commit bbd2d5a8120771, which will be in 6.0 and 5.2.1.



