graphic: 0.823
socket: 0.800
device: 0.766
semantic: 0.748
instruction: 0.743
mistranslation: 0.738
other: 0.730
network: 0.710
assembly: 0.710
KVM: 0.602
boot: 0.560
vnc: 0.533

virtual fat do not working in qemu 1.5.0

Guest : windows Seven / XP
Qemu version : 1.5.0 
cmd line : 
-drive file=fat:floppy:/mnt/vdisk/diskconf/TEST004/,if=none,id=drive-fdc0-0-0,readonly=on 
generated by  libvirt :
 
<disk type='dir' device='floppy'>
      <driver name='qemu' type='fat'/>
      <source dir='/mnt/vdisk/diskconf/TEST003/'/>
      <target dev='fda' bus='fdc'/>
      <readonly/>
      <alias name='fdc0-0-0'/>
      <address type='drive' controller='0' bus='0' target='0' unit='0'/>
    </disk>

works with qemu <= 1.4.1

with qemu 1.5.0 , guest does not see the floppy content.

Regards

same issue with qemu 1.5.1
floopy content is seen under linux. not under Windows guest

On Fri, May 31, 2013 at 03:26:47PM -0000, prochazka nicolas wrote:
> Public bug reported:
> 
> Guest : windows Seven / XP
> Qemu version : 1.5.0 
> cmd line : 
> -drive file=fat:floppy:/mnt/vdisk/diskconf/TEST004/,if=none,id=drive-fdc0-0-0,readonly=on 
> generated by  libvirt :
>  
> <disk type='dir' device='floppy'>
>       <driver name='qemu' type='fat'/>
>       <source dir='/mnt/vdisk/diskconf/TEST003/'/>
>       <target dev='fda' bus='fdc'/>
>       <readonly/>
>       <alias name='fdc0-0-0'/>
>       <address type='drive' controller='0' bus='0' target='0' unit='0'/>
>     </disk>
> 
> works with qemu <= 1.4.1
> 
> with qemu 1.5.0 , guest does not see the floppy content.

Thanks for reporting this bug.  The vvfat block driver is not actively
maintained, but you can help us track down this bug:

Since it used to work in QEMU 1.4.1 you could use git-bisect(1) to
identify the commit that broke vvfat.

http://git-scm.com/book/en/Git-Tools-Debugging-with-Git#Binary-Search
https://www.kernel.org/pub/software/scm/git/docs/git-bisect.html
http://code-worrier.com/blog/git-bisect-basics/

Something along the lines of:

$ git clone git://git.qemu.org/qemu.git
$ cd qemu
$ git bisect start
$ git bisect bad master
$ git bisect good v1.4.1

Then build from source and test at each bisect step:

$ ./configure --target-list=x86_64-softmmu && make
$ qemu -drive file=fat:floppy:...

If it fails:

$ git bisect bad

If it succeeds:

$ git bisect good

At the end of the process it will tell you which commit broke vvfat.

Stefan


Triaging old bug tickets... Have you ever bisected the problem? Can you still reproduce this issue with the latest version of QEMU? Or could we close this ticket nowadays?

[Expired for QEMU because there has been no activity for 60 days.]

