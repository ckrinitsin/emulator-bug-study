other: 0.135
permissions: 0.131
device: 0.117
socket: 0.094
PID: 0.090
files: 0.089
semantic: 0.060
vnc: 0.056
network: 0.051
graphic: 0.046
debug: 0.043
performance: 0.037
boot: 0.034
KVM: 0.015
debug: 0.545
files: 0.178
other: 0.060
device: 0.036
network: 0.029
KVM: 0.022
semantic: 0.022
socket: 0.020
PID: 0.019
boot: 0.018
performance: 0.016
permissions: 0.013
vnc: 0.011
graphic: 0.010

the vhd generated by qemu-img not align with MB again.

I'm using this version on xenial,
andy@bastion:~/temp$ qemu-img -h
qemu-img version 2.5.0 (Debian 1:2.5+dfsg-5ubuntu10.31), Copyright (c) 2004-2008 Fabrice Bellard

steps to repro:

dd if=/dev/zero of=/tmp/azure_config_disk_image20180901-22672-16zxelu bs=1048576 count=24
mkfs.ext4 -F /tmp/azure_config_disk_image20180901-22672-16zxelu -L azure_cfg_dsk
sudo -n mount -o loop /tmp/azure_config_disk_image20180901-22672-16zxelu /tmp/azure_config_disk_mount66c11d7a-5f2b-4ed5-b959-3b48dbc42a2a20180901-22672-1ejreat
sudo -n chown andy /tmp/azure_config_disk_mount66c11d7a-5f2b-4ed5-b959-3b48dbc42a2a20180901-22672-1ejreat
mkdir -p /tmp/azure_config_disk_mount66c11d7a-5f2b-4ed5-b959-3b48dbc42a2a20180901-22672-1ejreat/configs
sudo -n umount /tmp/azure_config_disk_mount66c11d7a-5f2b-4ed5-b959-3b48dbc42a2a20180901-22672-1ejreat
qemu-img convert -f raw -O vpc -o subformat=fixed,force_size /tmp/azure_config_disk_image20180901-22672-16zxelu papapa2.vhd

unfortunately the papapa2.vhd size is 25166336!=25165824 which means it's not aligned in MiB.

could you please help?

last bug report and fixed is https://bugs.launchpad.net/qemu/+bug/1490611

and even the format is raw:
andy@bastion:~/temp$ qemu-img info papapa2.vhd 
image: papapa2.vhd
file format: raw
virtual size: 24M (25166336 bytes)
disk size: 152K

It is -o subformat=fixed   which breaks the file format detection

