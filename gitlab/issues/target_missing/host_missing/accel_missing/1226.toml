id = 1226
title = "wheel-axis=false does not get applied at hardware init stage"
state = "opened"
created_at = "2022-09-24T11:36:26.214Z"
closed_at = "n/a"
labels = ["device:input", "device:virtio"]
url = "https://gitlab.com/qemu-project/qemu/-/issues/1226"
host-os = "Arch"
host-arch = "x86"
qemu-version = "7.1.50 (v7.1.0-406-g6160d8ff81-dirty)"
guest-os = "Bliss OS (android 12)"
guest-arch = "x86"
description = """`-device virtio-tablet,id=touch0,wheel-axis=false` does not get applied at initalization stage, causing android to see it and treat the device as a pointer instead of a tablet. it seems to look for the prop at init stage, I have verified that this is an issue by fixing it with a quick hack below. ~~setting `-device virtio-tablet,id=touch0,wheel-axis=true` will still work fine and cause android to pick it up as a pointer again~~


EDIT: It does not seem to work actually. if set when the default is set to false"""
reproduce = """1. Boot android based VM
2. test an app that forces touch only over pointer"""
additional = """```
diff --git a/hw/input/virtio-input-hid.c b/hw/input/virtio-input-hid.c
index a7a244a95d..3175f9c7d5 100644
--- a/hw/input/virtio-input-hid.c
+++ b/hw/input/virtio-input-hid.c
@@ -477,7 +477,7 @@ static struct virtio_input_config virtio_tablet_config_v2[] = {
 };
 
 static Property virtio_tablet_properties[] = {
-    DEFINE_PROP_BOOL("wheel-axis", VirtIOInputHID, wheel_axis, true),
+    DEFINE_PROP_BOOL("wheel-axis", VirtIOInputHID, wheel_axis, false),
     DEFINE_PROP_END_OF_LIST(),
 };
 
```"""
