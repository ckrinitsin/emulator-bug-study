ERROR: sizeof(size_t) doesn't match GLIB_SIZEOF_SIZE_T.

cont build from last 2.6 rc4

~/Downloads/qemu-2.6.0-rc4$ ./configure 

ERROR: sizeof(size_t) doesn't match GLIB_SIZEOF_SIZE_T.
       You probably need to set PKG_CONFIG_LIBDIR
       to point to the right pkg-config files for your
       build target

Os Ubuntu Mate 16.04 PPC64

Please try this patch: http://patchwork.ozlabs.org/patch/616440/

The problem could also be that your build environment is broken in the way the warning is trying to diagnose (for instance that you have the 32-bit PPC glib development packages installed and not the 64-bit ones.)


thanks for the infos 
Stefan  i will check tomorrow and report.
Peter, yes this is an issue of the powerpc64 of ubuntu/debian the ppc64 libraries are half ported usually i fix changing in the makefile -m32 where -m64 is call i will try to force the flags on configure of qemu too. i  will report if success or not.

Peter just try forcing the cpp flagas with -m32 without success.
On this rc configure dont start build ..
CPPFLAGS="-m32" CFLAGS="-g -O2 -mcpu=e5500 -mno-altivec -mtune=e5500" CXXFLAGS="-m32 -g -O2 -mcpu=e5500 -mno-altivec -mtune=e5500" ./configure --disable-werror 

ERROR: sizeof(size_t) doesn't match GLIB_SIZEOF_SIZE_T.
       You probably need to set PKG_CONFIG_LIBDIR
       to point to the right pkg-config files for your
       build target

will check Stefan parch if something change and reports.

Thanks

If you can still see the bug after applying Stefan's patch, please attach the config.log file generated by configure

Ok Daniel, will check and report.
note usually on PPC we use ad default compiler GCC (5.3.1 now).
I been installed clang 3.8 and will check report if all will right.

Thanks

Hi guys, did the patch but same error appear.
i attached the config.log.



Ok so the log message associated with the failure is this:

cc -m32 -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -Wstrict-prototypes -Wredundant-decls -Wall -Wundef -Wwrite-strings -Wmissing-prototypes -fno-strict-aliasing -fno-common -Wendif-labels -Wmissing-include-dirs -Wempty-body -Wnested-externs -Wformat-security -Wformat-y2k -Winit-self -Wignored-qualifiers -Wold-style-declaration -Wold-style-definition -Wtype-limits -fstack-protector-strong -I/usr/include/p11-kit-1 -I/usr/local/include -I/usr/include/libpng12 -pthread -I/usr/include/glib-2.0 -I/usr/lib/powerpc-linux-gnu/glib-2.0/include -g -o config-temp/qemu-conf.exe config-temp/qemu-conf.c -m32 -g -lgthread-2.0 -pthread -lglib-2.0 -lz
In file included from /usr/include/glib-2.0/glib.h:79:0,
                 from config-temp/qemu-conf.c:1:
/usr/include/glib-2.0/glib/gstrfuncs.h:301:2: error: #endif without #if
 #endif /* __G_STRFUNCS_H__ */


Which rather suggests your glib header files are broken.

Hi Daniel i dont know 
from this last i have this issue other versions was building right .
im affraid i deleted the rc3 i just make a test with 2.5.1 and you can see configure work, like was working in past.




rc5 same issue 

./configure 

ERROR: sizeof(size_t) doesn't match GLIB_SIZEOF_SIZE_T.
       You probably need to set PKG_CONFIG_LIBDIR
       to point to the right pkg-config files for your
       build target

thanks

I think Daniel is right -- your glib headers are broken, and we just weren't diagnosing it before. You need to fix your glib install.


Hi  Perter, 
probalby ... i found something wrongs inside my ppc64 library , im clearing and reinstall the glib . report it soon

Yes Fixed guys.
configure reply right . can close this bug , that was not a qemu bug.

